<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Input and output | FBS consolidation process</title>
  <meta name="description" content="This is the documentation for the FBS Consolidation process." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Input and output | FBS consolidation process" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/SWS-Methodology/FbsConsolidation/./images/FAO_logo.svg.png" />
  <meta property="og:description" content="This is the documentation for the FBS Consolidation process." />
  <meta name="github-repo" content="https://github.com/SWS-Methodology/faoswsFbsConsolidationDocumentation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Input and output | FBS consolidation process" />
  
  <meta name="twitter:description" content="This is the documentation for the FBS Consolidation process." />
  <meta name="twitter:image" content="https://github.com/SWS-Methodology/FbsConsolidation/./images/FAO_logo.svg.png" />

<meta name="author" content="Author: Riccardo Giubilei" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="./images/FAO_logo.svg.ico" type="image/x-icon" />
<link rel="prev" href="index.html"/>
<link rel="next" href="Plugin.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/SWS-Methodology/faoswsFbsConsolidationDocumentation">FBS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#food-balance-sheets-data"><i class="fa fa-check"></i><b>1.1</b> Food Balance Sheets data</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#goal-of-the-fbs-consolidation-process"><i class="fa fa-check"></i><b>1.2</b> Goal of the FBS consolidation process</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#summary"><i class="fa fa-check"></i><b>1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="InputOutput.html"><a href="InputOutput.html"><i class="fa fa-check"></i><b>2</b> Input and output</a>
<ul>
<li class="chapter" data-level="2.1" data-path="InputOutput.html"><a href="InputOutput.html#input-datatables"><i class="fa fa-check"></i><b>2.1</b> Input datatables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated-area-aggregates"><i class="fa fa-check"></i><b>2.1.1</b> FBS Consolidated Area Aggregates</a></li>
<li class="chapter" data-level="2.1.2" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated-elements"><i class="fa fa-check"></i><b>2.1.2</b> FBS Consolidated Elements</a></li>
<li class="chapter" data-level="2.1.3" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated-exceptions"><i class="fa fa-check"></i><b>2.1.3</b> FBS Consolidated Exceptions</a></li>
<li class="chapter" data-level="2.1.4" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated-code-mapping"><i class="fa fa-check"></i><b>2.1.4</b> FBS Consolidated Code Mapping</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="InputOutput.html"><a href="InputOutput.html#input-codelists"><i class="fa fa-check"></i><b>2.2</b> Input codelists</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="InputOutput.html"><a href="InputOutput.html#geographicaream49-codelist"><i class="fa fa-check"></i><b>2.2.1</b> <em>geographicAreaM49</em> codelist</a></li>
<li class="chapter" data-level="2.2.2" data-path="InputOutput.html"><a href="InputOutput.html#measureditemfbssua-codelist"><i class="fa fa-check"></i><b>2.2.2</b> <em>measuredItemFbsSua</em> codelist</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="InputOutput.html"><a href="InputOutput.html#input-datasets"><i class="fa fa-check"></i><b>2.3</b> Input datasets</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="InputOutput.html"><a href="InputOutput.html#clfs-input-dataset"><i class="fa fa-check"></i><b>2.3.1</b> CLFS input dataset</a></li>
<li class="chapter" data-level="2.3.2" data-path="InputOutput.html"><a href="InputOutput.html#nfiss-input-dataset"><i class="fa fa-check"></i><b>2.3.2</b> NFISS input dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="InputOutput.html"><a href="InputOutput.html#output-datatable"><i class="fa fa-check"></i><b>2.4</b> Output datatable</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated-logs"><i class="fa fa-check"></i><b>2.4.1</b> FBS Consolidated Logs</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="InputOutput.html"><a href="InputOutput.html#output-datasets"><i class="fa fa-check"></i><b>2.5</b> Output datasets</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="InputOutput.html"><a href="InputOutput.html#fbs-consolidated"><i class="fa fa-check"></i><b>2.5.1</b> FBS Consolidated</a></li>
<li class="chapter" data-level="2.5.2" data-path="InputOutput.html"><a href="InputOutput.html#fbs-sofi"><i class="fa fa-check"></i><b>2.5.2</b> FBS SOFI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Plugin.html"><a href="Plugin.html"><i class="fa fa-check"></i><b>3</b> FBS consolidation plugin</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Plugin.html"><a href="Plugin.html#InputParams"><i class="fa fa-check"></i><b>3.1</b> Input parameters</a></li>
<li class="chapter" data-level="3.2" data-path="Plugin.html"><a href="Plugin.html#AutoRetrieval"><i class="fa fa-check"></i><b>3.2</b> Automatic retrieval with queries</a></li>
<li class="chapter" data-level="3.3" data-path="Plugin.html"><a href="Plugin.html#Workflow"><i class="fa fa-check"></i><b>3.3</b> Workflow</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Plugin.html"><a href="Plugin.html#Preliminary"><i class="fa fa-check"></i><b>3.3.1</b> Preliminary operations</a></li>
<li class="chapter" data-level="3.3.2" data-path="Plugin.html"><a href="Plugin.html#DataImport"><i class="fa fa-check"></i><b>3.3.2</b> Data import</a></li>
<li class="chapter" data-level="3.3.3" data-path="Plugin.html"><a href="Plugin.html#PostImport"><i class="fa fa-check"></i><b>3.3.3</b> Post-import processing operations</a></li>
<li class="chapter" data-level="3.3.4" data-path="Plugin.html"><a href="Plugin.html#Saving"><i class="fa fa-check"></i><b>3.3.4</b> Saving procedure</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Plugin.html"><a href="Plugin.html#WorkflowSummary"><i class="fa fa-check"></i><b>3.4</b> Workflow summary</a></li>
<li class="chapter" data-level="3.5" data-path="Plugin.html"><a href="Plugin.html#CompoundElements"><i class="fa fa-check"></i><b>3.5</b> Equations of compound elements</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="RunPlugin.html"><a href="RunPlugin.html"><i class="fa fa-check"></i><b>4</b> How to run the plugin</a>
<ul>
<li class="chapter" data-level="4.1" data-path="RunPlugin.html"><a href="RunPlugin.html#Secondary"><i class="fa fa-check"></i><b>4.1</b> On secondary datasets</a></li>
<li class="chapter" data-level="4.2" data-path="RunPlugin.html"><a href="RunPlugin.html#Guide"><i class="fa fa-check"></i><b>4.2</b> Step-by-step guide</a></li>
<li class="chapter" data-level="4.3" data-path="RunPlugin.html"><a href="RunPlugin.html#Flowchart"><i class="fa fa-check"></i><b>4.3</b> Flowchart</a></li>
<li class="chapter" data-level="4.4" data-path="RunPlugin.html"><a href="RunPlugin.html#BestPractices"><i class="fa fa-check"></i><b>4.4</b> Best practices</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FBS consolidation process</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="InputOutput" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Input and output<a href="InputOutput.html#InputOutput" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The <strong>FBS consolidation process</strong> is performed using a single plugin: <em>fbs_consolidation</em>. The plugin uses several input objects to update one output datatable and two output datasets. This chapter describes these input and output objects in detail.</p>
<p>The plugin processes information from <strong>four input datatables</strong>:<br />
- <em>fbs_consolidated_area_aggregates</em> in the <em>Disseminated Datasets</em> domain.<br />
- <em>fbs_consolidated_elements</em> in the <em>Disseminated Datasets</em> domain.<br />
- <em>fbs_consolidated_exceptions</em> in the <em>Disseminated Datasets</em> domain.<br />
- <em>fbs_consolidated_code_mapping</em> in the <em>Disseminated Datasets</em> domain.<br />
</p>
<p>Additionally, it retrieves reference information from <strong>two input codelists</strong>:<br />
- <em>geographicAreaM49</em>.<br />
- <em>measuredItemFbsSua</em>.<br />
</p>
<p>The plugin gathers input data from <strong>two input datasets</strong>:<br />
- <em>fbs_balanced_</em> in the <em>SUA/FBS Domain</em> (CLFS team).<br />
- <em>fi_fbs_faostat_validated</em> in the <em>Fisheries Commodities</em> domain (NFISS team).<br />
</p>
<p>It writes information about the plugin runs to a <strong>single output datatable</strong>:<br />
- <em>fbs_consolidated_logs</em> in the <em>Disseminated Datasets</em> domain.<br />
</p>
<p>Finally, it updates data into <strong>two output datasets</strong>:<br />
- <em>fbs_consolidated</em> in the <em>Disseminated Datasets</em> domain.<br />
- <em>fbs_sofi</em> in the <em>Food Security</em> domain.<br />
</p>
<p>The following sections describe each object in more detail.</p>
<div id="input-datatables" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Input datatables<a href="InputOutput.html#input-datatables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>fbs_consolidation</em> plugin uses <strong>four input datatables</strong> to retrieve key information necessary for data processing.</p>
<div id="fbs-consolidated-area-aggregates" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> FBS Consolidated Area Aggregates<a href="InputOutput.html#fbs-consolidated-area-aggregates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>FBS Consolidated Area Aggregates</em> datatable specifies <strong>the list of area aggregates to include in the process</strong>. The composition of each area aggregate is then retrieved using the <em>geographicAreaM49</em> codelist.</p>
<p>Key identifiers for this datatable are:<br />
- Domain id: <code>disseminated</code>.<br />
- Datatable id: <code>fbs_consolidated_area_aggregates</code>.</p>
<p>As illustrated in Figure <a href="#fig:AreaAggregatesDT">2.1</a>, the datatable has <strong>two columns</strong>:<br />
- <em>Code</em>, containing the M49 code of the area aggregate.<br />
- <em>Description</em>, containing the description of the area aggregate.<br />
</p>
<p>Currently, the datatable includes 35 area aggregates.</p>
<div class="note">
The list of aggregates included in the <em>FBS Consolidated Area Aggregates</em> datatable is designed to be <strong>flexible</strong> and can be updated upon request from data owners.
</div>
<div class="float">
<img src="images/fbs_consolidation_area_aggregates.png" alt=" Figure 2.1. Datatable presenting the list of area aggregates to include in the FBS consolidation process." />
<div class="figcaption"> Figure 2.1. Datatable presenting the list of area aggregates to include in the FBS consolidation process.</div>
</div>
</div>
<div id="fbs-consolidated-elements" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> FBS Consolidated Elements<a href="InputOutput.html#fbs-consolidated-elements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>FBS Consolidated Elements</em> datatable defines <strong>the list of input and output elements, including conversion multipliers and formulas used to compute compound elements</strong>.</p>
<p>Key identifiers for this datatable are:<br />
- Domain id: <code>disseminated</code>.<br />
- Datatable id: <code>fbs_consolidated_elements</code>.</p>
<p>One of the main objectives of the FBS consolidation process is to harmonize FBS data produced by the CLFS and the NFISS teams. The list of output elements has been agreed upon with both teams. The <em>FBS Consolidated Elements</em> datatable provides instructions on how to derive these elements from each input dataset. This may involve directly retaining the input elements without further modifications, converting values from tonnes to 1000 tonnes, or computing compound elements using defined formulas.</p>
<p>As shown in Figure <a href="#fig:ElementsDT">2.2</a>, the datatable contains <strong>eight columns</strong>:<br />
- <em>CLFS input description</em> and <em>CLFS input code</em>, denoting the input elements from the CLFS input dataset.<br />
- <em>NFISS input description</em> and <em>NFISS input code</em>, denoting the input elements from the NFISS input dataset; NA indicates the element is not used by NFISS.<br />
- <em>Multiplier</em>, specifying the conversion factor applied to input elements to derive output elements; it is set to NA when the input element is part of a formula used to compute a compound output element.<br />
- <em>Formula</em>, providing equations for calculating compound output elements; input elements used in the same operation share the same formula.<br />
- <em>Output description</em> and <em>Output code</em>, denoting the output elements; these may include duplicated values when multiple input elements contribute to the calculation of a single compound output element, resulting in multiple rows per output element.<br />
</p>
<div class="note">
Population data is retrieved only from the CLFS input dataset.
</div>
<p>The total number of unique output elements considered in the FBS consolidation process is 21.</p>
<div class="float">
<img src="images/fbs_consolidation_elements.png" alt=" Figure 2.2. Datatable presenting the list of input and output elements, including conversion multipliers and formulas used to compute compound elements." />
<div class="figcaption"> Figure 2.2. Datatable presenting the list of input and output elements, including conversion multipliers and formulas used to compute compound elements.</div>
</div>
</div>
<div id="fbs-consolidated-exceptions" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> FBS Consolidated Exceptions<a href="InputOutput.html#fbs-consolidated-exceptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>FBS Consolidated Exceptions</em> datatable defines <strong>the list of exceptions to be applied within the FBS consolidation process</strong>.</p>
<p>Key identifiers for this datatable are:<br />
- Domain id: <code>disseminated</code>.<br />
- Datatable id: <code>fbs_consolidated_exceptions</code>.</p>
<p>Each row in the datatable represents an exception, which can be <strong>unidimensional</strong> (e.g., all data for one element, regardless of areas, items, or years) or <strong>multidimensional</strong> (e.g., all data for a given combination of area-item-element). Exceptions are applied during two possible steps:<br />
- <strong>Dissemination step</strong>, meaning the data is not published.<br />
- <strong>Aggregation step</strong>, meaning data is excluded from area or item aggregates.</p>
<p>The most common case is for the exception to be applied in both cases. However, there are exceptions where data may be aggregated but not disseminated (or viceversa).</p>
<div class="note">
Dissemination-only exceptions (such as <em>Palestine</em>, which is considered in area aggregates but is not published as a distinct area) are not applied within the FBS consolidation process to ensure the reproducibility of results across different plugin runs. They will instead be applied when SWS data is exported to the dissemination platform.
</div>
<p>As shown in Figure <a href="#fig:ExceptionsDT">2.3</a>, the datatable has <strong>ten columns</strong>:<br />
- <em>Area Code</em> and <em>Area</em>, representing areas.<br />
- <em>Item Code</em> and <em>Item</em>, representing items.<br />
- <em>Element Code</em> and <em>Element</em>, representing output elements.<br />
- <em>Year Code</em> and <em>Year</em>, representing years. <em>Year</em> is usually left blank, while <em>Year Code</em> may include multiple years using ‘&gt;’ or ‘&lt;’ symbols.<br />
- <em>Dissemination Flag</em>, which is set to ‘NO’ if the exception must be applied during the dissemination step and is blank otherwise.<br />
- <em>Aggregation Flag</em>, which is set to ‘NO’ if the exception must be applied during the aggregation step and is blank otherwise.<br />
</p>
<p>The datatable was adapted from a similar table used for dissemination to FAOSTAT. The datatable includes updated codes and labels, as well as additional instances for teams’ partial item aggregates and for 42 areas.</p>
<div class="note">
The list of exceptions included in the <em>FBS Consolidated Exceptions</em> datatable is designed to be <strong>flexible</strong> and can be updated upon request from data owners.
</div>
<div class="float">
<img src="images/fbs_consolidation_exceptions.png" alt=" Figure 2.3. Datatable presenting the list of exceptions to be applied within the FBS consolidation process." />
<div class="figcaption"> Figure 2.3. Datatable presenting the list of exceptions to be applied within the FBS consolidation process.</div>
</div>
</div>
<div id="fbs-consolidated-code-mapping" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> FBS Consolidated Code Mapping<a href="InputOutput.html#fbs-consolidated-code-mapping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>FBS Consolidated Code Mapping</em> datatable defines <strong>the mapping operations between input codes and output (consolidated) codes</strong>.</p>
<p>Key identifiers for this datatable are:<br />
- Domain id: <code>disseminated</code>.<br />
- Datatable id: <code>fbs_consolidated_code_mapping</code>.</p>
<p>There are several reasons why the output codes may not be directly available within the input datasets. These include:<br />
- Old codes still in use while awaiting migration to new codes.<br />
- Item aggregates that include only one component (either the CLFS or the NFISS one).<br />
- Use of different codelists for the same dimension between input and output datasets.</p>
<p>In these cases, the <em>FBS Consolidated Code Mapping</em> datatable provides essential information on how to perform mapping operations between input and output codes.</p>
<div class="note">
The <em>fbs_consolidation</em> plugin is designed to be <strong>robust</strong> to potential updates from old codes to new codes in the input datasets. This ensures the plugin’s functionality remains unaffected after migrations aimed at aligning the input codes with the output ones.
</div>
<p>As shown in Figure <a href="#fig:CodeMappingDT">2.4</a>, the datatable has <strong>five columns</strong>:<br />
- <em>Type</em>, describing which dimension is affected by the mapping operation.<br />
- <em>NFISS item CL</em>, a logical value indicating whether the mapping pertains to items from the NFISS item codelist.<br />
- <em>Description</em>, providing the description of the code being mapped.<br />
- <em>Old</em>, showing the old code.<br />
- <em>New</em>, showing the new code.</p>
<div class="float">
<img src="images/fbs_consolidation_code_mapping.png" alt=" Figure 2.4. Datatable defining the mapping operations between input codes and output (consolidated) codes." />
<div class="figcaption"> Figure 2.4. Datatable defining the mapping operations between input codes and output (consolidated) codes.</div>
</div>
</div>
</div>
<div id="input-codelists" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Input codelists<a href="InputOutput.html#input-codelists" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Along with the input datatables, the <em>fbs_consolidation</em> plugin uses <strong>two input codelists</strong> to extract key information for data processing.</p>
<div id="geographicaream49-codelist" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> <em>geographicAreaM49</em> codelist<a href="InputOutput.html#geographicaream49-codelist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>geographicAreaM49</em> codelist is used to retrieve <strong>the composition of area aggregates</strong>. Specifically, the constituents of each aggregate are determined by its corresponding leaves in the hierarchy defined by the codelist.</p>
</div>
<div id="measureditemfbssua-codelist" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> <em>measuredItemFbsSua</em> codelist<a href="InputOutput.html#measureditemfbssua-codelist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>measuredItemFbsSua</em> codelist is used to retrieve <strong>the composition of item aggregates</strong>. As for <em>geographicAreaM49</em>, the constituents of each aggregate are given by its corresponding leaves in the hierarchy defined by the codelist.</p>
</div>
</div>
<div id="input-datasets" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Input datasets<a href="InputOutput.html#input-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Input data for the FBS consolidation process is provided by two input datasets, one for each of the two teams producing FBS data:<br />
- The <em>Crops, Livestocks, and Food Statistics</em> (CLFS) team of the <em>Statistics division</em> (ESS).<br />
- The <em>Fisheries and Aquaculture Statistics</em> (NFISS) team of the <em>Fisheries division</em> (NFI).</p>
<p>The two input datasets are briefly introduced below.</p>
<div class="note">
Since the <em>fbs_consolidation</em> plugin does not read data directly from SWS sessions, it is essential to make relevant data available by saving the data points to the input datasets.
</div>
<div id="clfs-input-dataset" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> CLFS input dataset<a href="InputOutput.html#clfs-input-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The CLFS team’s input dataset is <em>fbs_balanced</em> from the <em>SUA/FBS Domain</em>.</p>
<p>Key identifiers for this dataset are:<br />
- Domain id: <code>suafbs</code>.<br />
- Dataset id: <code>fbs_balanced_</code>.</p>
<p>The CLFS input dataset uses the following codelists for its four dimensions:<br />
- Areas: <em>geographicAreaM49</em>.<br />
- Elements: <em>measuredElementSuaFbs</em>.<br />
- Items: <em>measuredItemFbsSua</em>.<br />
- Years: <em>timePointYears</em>.</p>
</div>
<div id="nfiss-input-dataset" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> NFISS input dataset<a href="InputOutput.html#nfiss-input-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The NFISS team’s input dataset is <em>FBS fisheries - FAOSTAT standardized (Validated)</em> from the <em>Fisheries Commodities</em> domain.</p>
<p>Key identifiers for this dataset are:<br />
- Domain id: <code>FisheriesCommodities</code>.<br />
- Dataset id: <code>fi_fbs_faostat_validated</code>.</p>
<p>The NFISS input dataset uses the following codelists for its four dimensions:<br />
- Areas: <em>geographicAreaM49_fi</em>.<br />
- Elements: <em>measuredElementSuaFbs</em>.<br />
- Items: <em>measuredItemFaostat_L2</em>.<br />
- Years: <em>timePointYears</em>.</p>
</div>
</div>
<div id="output-datatable" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Output datatable<a href="InputOutput.html#output-datatable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>fbs_consolidation</em> plugin writes to a <strong>single output datatable</strong>, which serves as a registry of all plugin’s runs.</p>
<div id="fbs-consolidated-logs" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> FBS Consolidated Logs<a href="InputOutput.html#fbs-consolidated-logs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>FBS Consolidated Logs</em> datatable <strong>records all runs of the plugin, providing essential information to facilitate collaboration between teams</strong>.</p>
<p>Key identifiers for this datatable are:<br />
- Domain id: <code>disseminated</code>.<br />
- Datatable id: <code>fbs_consolidated_logs</code>.</p>
<p>The <em>FBS Consolidated Logs</em> datatable serves <strong>multiple purposes</strong>:<br />
- It records all plugin runs.<br />
- It summarizes key details for each run, including the user, date and time, runtime, input and output datasets, whether the query was used, the years, and the number and codes of countries involved.<br />
- It facilitates coordination between teams by indicating whether a plugin run is currently active or was recently completed. In this case, one team can contact the other to confirm whether the results were saved to the output dataset(s), minimizing the risk of conflicting sessions.</p>
<div class="warning">
Conflicts may occur when independent plugin runs have overlapping input-output operations. For example, a conflict arises if a second user reads data from the output dataset before the first user has saved their results.
</div>
<p>On a positive note, the SWS UI alerts you to such issues by displaying a small “C” next to the red circle in the sessions list. The downside is that the conflicting session must be aborted and re-run. This highlights the <strong>importance of maintaining a datatable to log the runs</strong> executed by each user. While this does not prevent conflicts - since the plugin’s results still need to be saved back to the dataset - it allows teams to reach out to each other to confirm whether their changes have already been saved.</p>
<div class="tip">
Regurarly check the <em>FBS Consolidated Logs</em> datatable when using the plugin, especially before launching new runs.
</div>
<p>The datatable, shown in Figure <a href="#fig:LogsDT">2.5</a>, has <strong>12 columns</strong>. The most relevant fields include:<br />
- <em>ID</em>, a unique identifier that can be used to chronologically sort the plugin runs.<br />
- <em>Runtime</em>, displaying the computational time that was required to complete the task. If the value is ‘-’, it means the plugin either failed or is still running.<br />
- <em>FBS Cons Session</em> and <em>FBS SOFI Session</em>, providing the ID of the SWS sessions associated with each run. This information helps users easily retrieve the results of previous runs. If the field is blank, it means that the run did not update the corresponding output dataset.<br />
- <em>Query</em>, indicating whether the plugin was launched considering the query.<br />
- <em>Areas No.</em> and <em>Areas Codes</em>, respectively indicating the number of areas and the list of area codes considered for the run. This information is useful for coordination between teams.</p>
<div class="float">
<img src="images/fbs_consolidation_logs.png" alt=" Figure 2.5. Datatable providing detailed information on all the runs of the fbs_consolidation plugin." />
<div class="figcaption"> Figure 2.5. Datatable providing detailed information on all the runs of the <em>fbs_consolidation</em> plugin.</div>
</div>
</div>
</div>
<div id="output-datasets" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Output datasets<a href="InputOutput.html#output-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>fbs_consolidation</em> plugin updates <strong>two output datasets</strong>: <em>FBS Consolidated</em> (in the <em>Disseminated Dataset</em> domain) and <em>FBS SOFI</em> (in the <em>Food Security</em> domain).</p>
<p><em>FBS Consolidated</em> is the dissemination dataset. It is updated ideally twice per year. <em>FBS SOFI</em> is the “live” dataset, meaning that data is updated on a rolling basis, following the deadlines for <em>The State of Food Security and Nutrition in the World</em> (SOFI) report.</p>
<p>Following a careful review, it was concluded that both output datasets should adopt the following codelists:<br />
- Areas: <em>geographicAreaM49</em>.<br />
- Elements: <em>measuredElementSuaFbs</em>.<br />
- Items: <em>measuredItemFbsSua</em>.<br />
- Years: <em>timePointYears</em>.</p>
<p>The roots included for the <em>Areas</em> dimension are <em>World</em> [1] and <em>Economic Areas</em> [ECO]. The elements made available are 21. The item codelist is limited to the roots <em>Grand Total</em> [S2901] and <em>Additional aggregates, not elsewhere specified</em> [NES], and to <em>TOTAL POPULATION</em> [S2501]. The <em>Years</em> dimension is not restricted, but data points are available only from 2010 onwards, in line with the implementation of the new FBS methodology<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>Table <a href="InputOutput.html#tab:codelists">2.1</a> summarizes the codelists used for the four dimensions in both input and output datasets.</p>
<table>
<caption><span id="tab:codelists">Table 2.1: </span> Codelists used for the four dimensions in the two input datasets (<em>fbs_balanced_</em> and <em>fi_fbs_faostat_validated</em>) and the two output datasets (<em>fbs_consolidated</em> and <em>fbs_sofi</em>).</caption>
<colgroup>
<col width="24%" />
<col width="19%" />
<col width="21%" />
<col width="18%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Areas</th>
<th>Elements</th>
<th>Items</th>
<th>Years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>fbs_balanced_</strong></td>
<td>geographicAreaM49</td>
<td>measuredElementSuaFbs</td>
<td>measuredItemFbsSua</td>
<td>timePointYears</td>
</tr>
<tr class="even">
<td><strong>fi_fbs_faostat_validated</strong></td>
<td>geographicAreaM49_fi</td>
<td>measuredElementSuaFbs</td>
<td>measuredItemFaostat_L2</td>
<td>timePointYears</td>
</tr>
<tr class="odd">
<td><strong>fbs_consolidated</strong></td>
<td>geographicAreaM49</td>
<td>measuredElementSuaFbs</td>
<td>measuredItemFbsSua</td>
<td>timePointYears</td>
</tr>
<tr class="even">
<td><strong>fbs_sofi</strong></td>
<td>geographicAreaM49</td>
<td>measuredElementSuaFbs</td>
<td>measuredItemFbsSua</td>
<td>timePointYears</td>
</tr>
</tbody>
</table>
<div class="note">
To enable the computation of inter-team aggregates, both output datasets have been initially populated with the disseminated FAOSTAT version of data for all years. Future updates will be made exclusively using the <em>fbs_consolidation</em> plugin.
</div>
<div id="fbs-consolidated" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> FBS Consolidated<a href="InputOutput.html#fbs-consolidated" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first output dataset is <em>FBS Consolidated</em>, available in the <em>Disseminated Datasets</em> domain.</p>
<p>Key identifiers for this dataset are:<br />
- Domain id: <code>disseminated</code>.<br />
- Dataset id: <code>fbs_consolidated</code>.</p>
<p><em>FBS Consolidated</em> is the <strong>dissemination dataset</strong>. Updates are tipically made twice a year: when the FBS cycle ends, and when the NFISS cycle ends. Disseminated versions are tagged and can be retrieved through the SWS interface. Tags are generated by the CLFS team with <strong>at least one week’s notice</strong> to the NFISS team, allowing them time to save the most recent version of their data to the NFISS input dataset. The tagging operation is performed after receiving confirmation from the NFISS team.</p>
</div>
<div id="fbs-sofi" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> FBS SOFI<a href="InputOutput.html#fbs-sofi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The second output dataset is <em>FBS SOFI</em>, available in the <em>Food Security</em> domain.</p>
<p>Key identifiers for this dataset are:<br />
- Domain id: <code>food_security</code>.<br />
- Dataset id: <code>fbs_sofi</code>.</p>
<p><em>FBS SOFI</em> is considered the <strong>“live” dataset</strong>. Updates are made on an ongoing basis, whenever necessary. However, it is essential that relevant data be available by the SOFI deadlines set by the <em>Food Security</em> team.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>For further details, see the <a href="https://files-faostat.fao.org/production/FBS/Key%20differences%20between%20new%20and%20old%20FBS%20June2022%20.pdf">document</a> that explains the key differences between the old and the new FBS methodology.<a href="InputOutput.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Plugin.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SWS-Methodology/faoswsFbsConsolidationDocumentation/tree/main01_input_output.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/SWS-Methodology/faoswsFbsConsolidationDocumentation/tree/main01_input_output.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
